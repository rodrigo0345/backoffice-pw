import{A as j}from"./index-D_r6u122.js";import{i as h}from"./index-xEShUyOC.js";import{F as z}from"./FoodModelRepository-EukNaaBv.js";import{b as N,_ as H,c as g,a as t,d,w as r,T as J,e as v,o as n,f as u,n as D,g as k,F as O,r as U,t as C,h as P,p as W,i as X}from"./index-CqBfKhJj.js";import"./RepositoryInterface-TDgCEybl.js";class Y{constructor(){this.foodRepository=new z}createFood(o){if(isNaN(Number(o.price))||isNaN(Number(o.risk)))throw new Error("Price and Risk need to be a number");if(!(0<o.risk&&o.risk<=5))throw new Error("Risk needs to be between 0 and 5  ");return this.foodRepository.create(o)}updateFood(o,m){if(isNaN(Number(m.price))||isNaN(Number(m.risk)))throw new Error("Price and Risk need to be a number");if(!(0<m.risk&&m.risk<=5))throw new Error("Risk needs to be between 0 and 5  ");return this.foodRepository.update(o,m)}deleteFood(o){return this.foodRepository.delete(o)}findFood(o){return this.foodRepository.find(o)}listFood(o){return this.foodRepository.all(o)}}const E=new Y,Z={components:{AppModal:j},setup(){const p=N([]),o=N(1),m=N(""),e="addfood",b=N({isDeleted:!1}),f=N(null);function _(a){f.value=a}async function l(){p.value=await E.listFood(b.value).filter(a=>m.value.trim()===""?!0:a.name.toLowerCase().includes(m.value)).filter((a,i)=>i>=(o.value-1)*10&&i<o.value*10)}async function y(a){a.orderKey===b.value.orderKey&&(a.orderBy=b.value.orderBy==="asc"?"desc":"asc"),b.value={...b.value,...a},await l()}async function F(a){m.value=a,await l()}async function q(){b.value={isDeleted:!1},await l()}async function w(){o.value++,await l()}async function S(){o.value--,await l()}async function B(a){a<1&&(a=1),o.value=a,await l()}l();async function K(){const a=document.getElementById("food-name"),i=document.getElementById("food-price"),x=document.getElementById("food-risk");if(!a||!i||!x){h("Please fill all the fields",{type:"error"});return}if(!a.value||!i.value||!x.value){h("Please fill all the fields",{type:"error"});return}const R={name:a.value,risk:Number(x.value),id:0,price:Number(i.value),isDeleted:!1};try{await E.createFood(R)}catch(I){h(I.message,{type:"error"});return}document.getElementById("close-modal-"+e).click(),h("Food created",{type:"success"}),await B(1),await l()}async function A(a){try{await E.deleteFood(a),await l(),h("Food deleted",{type:"success"})}catch(i){h("Error deleting food: "+i.message,{type:"error"})}}async function s(){var M,V,Q,G;const a=document.getElementById("food-name-edit"),i=document.getElementById("food-risk-edit"),x=document.getElementById("food-price-edit"),R=document.getElementById("food-delete-edit");console.log({editedFood:f});const L=R?R.checked:!0,I={id:((M=f.value)==null?void 0:M.id)||0,...f.value,name:a.value||((V=f.value)==null?void 0:V.name)||"default",risk:i.value||((Q=f.value)==null?void 0:Q.risk)||"default",price:x.value||((G=f.value)==null?void 0:G.price)||"default",isDeleted:!L};if(!I.id){h("Error editing food: Food id not found",{type:"error"});return}try{await E.updateFood(I.id,I),await l(),h("Food edited",{type:"success"})}catch(T){h("Error editing food: "+T.message,{type:"error"});return}document.getElementById("close-modal-"+e+"-edit").click()}return{modalId:"addfood",foodService:E,document,deleteFood:A,foods:p,createFood:K,nextPage:w,previousPage:S,setPage:B,page:o,setQuery:y,resetQuery:q,query:b,setSearch:F,setEditFood:_,editedFood:f,editFood:s}}},c=p=>(W("data-v-25bcff0c"),p=p(),X(),p),$={class:"intro"},ee={class:"bg-image h-100"},te={class:"mask d-flex align-items-center h-100"},oe={class:"container"},ae={class:"row justify-content-center"},de={class:"col-12"},re={class:"d-flex align-items-center mb-3 gap-3 justify-content-between"},se=c(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[t("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"})],-1)),ie={class:"card shadow-2-strong"},le={class:"card-body"},ne={class:"table-responsive"},ce={class:"table table-borderless mb-0"},ue={scope:"col"},me=c(()=>t("p",{class:"p-0 m-0"},"Name",-1)),fe=c(()=>t("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),_e=[fe],ye={scope:"col"},he=c(()=>t("p",{class:"p-0 m-0"},"Price",-1)),ge=c(()=>t("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),ve=[ge],pe={scope:"col"},be=c(()=>t("p",{class:"p-0 m-0"},"Risk",-1)),we=c(()=>t("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),ke=[we],Ce={scope:"col"},Fe=c(()=>t("p",{class:"p-0 m-0"},"Id",-1)),Be=c(()=>t("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),xe=[Be],Ie={key:0,scope:"col"},Ne=["onClick"],Pe=["data-bs-target"],Ee=["data-bs-target"],Ae=["data-bs-target"],Re=["data-bs-target"],De={key:0,class:"custom-row"},qe=["onClick"],Se=c(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x text-white",viewBox:"0 0 16 16"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"})],-1)),Ke=[Se],Le={class:"container d-flex pt-4 justify-content-between"},Me=c(()=>t("span",{"aria-hidden":"true"},"«",-1)),Ve=c(()=>t("span",{"aria-hidden":"true"},"»",-1)),Qe=c(()=>t("div",null,null,-1));function Ge(p,o,m,e,b,f){var A;const _=v("CInputGroupText"),l=v("CFormInput"),y=v("CInputGroup"),F=v("CButton"),q=v("CButtonGroup"),w=v("CPaginationItem"),S=v("CPagination"),B=v("app-modal"),K=v("CFormCheck");return n(),g("section",$,[t("div",ee,[t("div",te,[t("main",oe,[t("div",ae,[t("div",de,[t("div",re,[d(y,{class:"w-25"},{default:r(()=>[d(_,null,{default:r(()=>[se]),_:1}),d(l,{onChange:o[0]||(o[0]=s=>e.setSearch(s.target.value)),placeholder:"Search","aria-label":"Search","aria-describedby":"search"})]),_:1}),d(q,{role:"group","aria-label":"Basic example"},{default:r(()=>[d(F,{color:"primary",active:!e.query.isDeleted,onClick:o[1]||(o[1]=s=>e.setQuery({isDeleted:!1}))},{default:r(()=>[u("Active")]),_:1},8,["active"]),d(F,{color:"primary",active:e.query.isDeleted,onClick:o[2]||(o[2]=s=>e.setQuery({isDeleted:!0}))},{default:r(()=>[u("Deleted")]),_:1},8,["active"])]),_:1})]),t("div",ie,[t("div",le,[t("div",ne,[d(J,{name:"fade"},{default:r(()=>[t("table",ce,[t("thead",null,[t("tr",null,[t("th",ue,[t("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:o[3]||(o[3]=s=>e.setQuery({orderKey:"name",orderBy:"asc"}))},[me,(n(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:D({transform:e.query.orderKey==="name"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},_e,4))])]),t("th",ye,[t("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:o[4]||(o[4]=s=>e.setQuery({orderKey:"price",orderBy:"asc"}))},[he,(n(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:D({transform:e.query.orderKey==="price"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},ve,4))])]),t("th",pe,[t("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:o[5]||(o[5]=s=>e.setQuery({orderKey:"risk",orderBy:"asc"}))},[be,(n(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:D({transform:e.query.orderKey==="risk"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},ke,4))])]),t("th",Ce,[t("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:o[6]||(o[6]=s=>e.setQuery({orderKey:"id",orderBy:"asc"}))},[Fe,(n(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:D({transform:e.query.orderKey==="id"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},xe,4))])]),e.query.isDeleted?k("",!0):(n(),g("th",Ie,"Delete"))])]),t("tbody",null,[(n(!0),g(O,null,U(e.foods,s=>(n(),g("tr",{key:s.id,onClick:a=>e.setEditFood(s),class:"table-row custom-row-parent"},[t("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},C(s.name),9,Pe),t("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},C(s.price),9,Ee),t("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},C(s.risk),9,Ae),t("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},C(s.id),9,Re),s.isDeleted?k("",!0):(n(),g("td",De,[t("button",{type:"button",class:"btn btn-danger btn-sm px-3",onClick:a=>e.deleteFood(s.id)},Ke,8,qe)]))],8,Ne))),128))])])]),_:1})])])])])]),t("div",Le,[d(S,{"aria-label":"Page navigation example"},{default:r(()=>[e.page>1?(n(),P(w,{key:0,"aria-label":"Previous",style:{cursor:"pointer"},onClick:e.previousPage},{default:r(()=>[Me]),_:1},8,["onClick"])):k("",!0),d(w,{active:""},{default:r(()=>[u(C(e.page),1)]),_:1}),e.foods.length==10?(n(),P(w,{key:1,onClick:o[7]||(o[7]=s=>e.setPage(e.page+1)),style:{cursor:"pointer"}},{default:r(()=>[u(C(e.page+1),1)]),_:1})):k("",!0),e.foods.length==10?(n(),P(w,{key:2,onClick:o[8]||(o[8]=s=>e.setPage(e.page+2)),style:{cursor:"pointer"}},{default:r(()=>[u(C(e.page+2),1)]),_:1})):k("",!0),e.foods.length==10?(n(),P(w,{key:3,"aria-label":"Next",onClick:e.nextPage,style:{cursor:"pointer"}},{default:r(()=>[Ve]),_:1},8,["onClick"])):k("",!0)]),_:1}),d(F,{"data-bs-toggle":"modal",type:"button","data-bs-target":"#"+e.modalId,color:"primary"},{default:r(()=>[u(" Add new food ")]),_:1},8,["data-bs-target"]),d(B,{targetId:e.modalId,title:"Add Food",description:"Create a new food",saveAction:e.createFood},{default:r(()=>[d(y,{class:"mb-3"},{default:r(()=>[d(_,null,{default:r(()=>[u("Name")]),_:1}),d(l,{id:"food-name",placeholder:"Name","aria-label":"Name","aria-describedby":"basic-addon1"})]),_:1}),d(y,{class:"mb-3"},{default:r(()=>[d(_,null,{default:r(()=>[u("Price (€)")]),_:1}),d(l,{id:"food-price",placeholder:"20€","aria-label":"Price","aria-describedby":"basic-addon1"})]),_:1}),d(y,{class:"mb-3"},{default:r(()=>[d(_,null,{default:r(()=>[u("Risk (0 - 5)")]),_:1}),d(l,{id:"food-risk",placeholder:"3.2","aria-label":"Risk","aria-describedby":"basic-addon1"})]),_:1})]),_:1},8,["targetId","saveAction"])]),Qe])]),d(B,{targetId:e.modalId+"-edit",title:(A=e.editedFood)==null?void 0:A.name,description:"Edit food",saveAction:e.editFood},{default:r(()=>{var s;return[d(y,{class:"mb-3"},{default:r(()=>{var a,i;return[d(_,null,{default:r(()=>[u(" Name ")]),_:1}),d(l,{id:"food-name-edit",placeholder:(a=e.editedFood)==null?void 0:a.name,"aria-label":"Name","aria-describedby":"basic-addon1",value:(i=e.editedFood)==null?void 0:i.name},null,8,["placeholder","value"])]}),_:1}),d(y,{class:"mb-3"},{default:r(()=>{var a,i;return[d(_,null,{default:r(()=>[u("Price (€)")]),_:1}),d(l,{id:"food-price-edit",placeholder:(a=e.editedFood)==null?void 0:a.price,"aria-label":"Price","aria-describedby":"basic-addon1",value:(i=e.editedFood)==null?void 0:i.price},null,8,["placeholder","value"])]}),_:1}),d(y,{class:"mb-3"},{default:r(()=>{var a,i;return[d(_,null,{default:r(()=>[u("Risk (0 - 5)")]),_:1}),d(l,{id:"food-risk-edit",placeholder:(a=e.editedFood)==null?void 0:a.risk,"aria-label":"Risk","aria-describedby":"basic-addon1",value:(i=e.editedFood)==null?void 0:i.risk},null,8,["placeholder","value"])]}),_:1}),(s=e.editedFood)!=null&&s.isDeleted?(n(),P(K,{key:0,id:"food-delete-edit",label:"Reactivate food"})):k("",!0)]}),_:1},8,["targetId","title","saveAction"])])])}const Ue=H(Z,[["render",Ge],["__scopeId","data-v-25bcff0c"]]);export{Ue as default};
