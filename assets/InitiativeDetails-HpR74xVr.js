import{A as ee,i as w}from"./index-Bs9HXGKW.js";import{r as B,_ as K,l as g,k as o,i as c,w as u,p as N,q as F,F as L,m as R,f as C,g as h,j as I,t as p,e as A,y as Z,z as ie,A as pe,v as G,x as X,T as ge,B as we}from"./index-DKk25Cfh.js";import{W as be,F as Ie,O as Ce,I as te}from"./InitiativeService-CLHRurnK.js";import{F as ke}from"./FoodModelRepository-EukNaaBv.js";import{I as xe,S as Me}from"./SuggestionRepository-CYBXsh7L.js";import{J as De,a as Pe,U as Be}from"./UserService-DC23xz9X.js";import{F as Fe}from"./FoodService-CMpHdTPP.js";import{M as Se}from"./MaterialService-C88B2Ujc.js";import"./RepositoryInterface-TDgCEybl.js";import"./MaterialRepository-CkyeY5IP.js";class qe{constructor(){this.initiativeRepository=new xe,this.suggestionRepository=new Me,this.workingInRepository=new be,this.jobRepository=new De,this.usersRepository=new Pe,this.foodRepository=new ke,this.foodListRepository=new Ie,this.orderRepository=new Ce}makeOrder(t,r){if(r.length===0)throw new Error("You must select at least one food item.");const e=[];if(r.forEach(s=>{const d=this.foodRepository.find({id:s.foodId});if(!d)throw new Error("Food not found.");e.push(d)}),t.price=e.reduce((s,d)=>{var v;return s+d.price*(((v=r.find(f=>f.foodId===d.id))==null?void 0:v.quantity)??0)},0),t.isDeleted=!1,t.status="pending",!this.initiativeRepository.find({id:t.initiativeId}))throw new Error("Initiative not found.");const m=this.orderRepository.create(t);return e.forEach(s=>{const d=r.find(v=>v.foodId===s.id);if(!d)throw new Error("Food not found.");this.foodListRepository.create({id:0,orderId:m.id,foodId:s.id,quantity:d.quantity})}),m}pickOrder(t){const r=this.orderRepository.find({id:t});if(!r)throw new Error("Order not found.");if(r.status==="completed")throw new Error("Order already completed.");if(r.status==="cancelled")throw new Error("Order was cancelled, request a new one.");return r.status="completed",this.orderRepository.update(t,r)}cancelOrder(t){const r=this.orderRepository.find({id:t});if(!r)throw new Error("Order not found.");if(r.status==="completed")throw new Error("Order already completed.");if(r.status==="cancelled")throw new Error("Order was already cancelled.");return r.status="cancelled",this.orderRepository.update(t,r)}}function S(a){const t=Object.prototype.toString.call(a);return a instanceof Date||typeof a=="object"&&t==="[object Date]"?new a.constructor(+a):typeof a=="number"||t==="[object Number]"||typeof a=="string"||t==="[object String]"?new Date(a):new Date(NaN)}function Ae(a,t){return a instanceof Date?new a.constructor(t):new Date(t)}const z=43200,ue=1440;let Oe={};function Ee(){return Oe}function me(a){const t=S(a),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+a-+r}function H(a,t){const r=S(a),e=S(t),n=r.getTime()-e.getTime();return n<0?-1:n>0?1:n}function We(a){return Ae(a,Date.now())}function Ne(a,t){const r=S(a),e=S(t),n=r.getFullYear()-e.getFullYear(),m=r.getMonth()-e.getMonth();return n*12+m}function Le(a){return t=>{const e=(a?Math[a]:Math.trunc)(t);return e===0?0:e}}function Re(a,t){return+S(a)-+S(t)}function Te(a){const t=S(a);return t.setHours(23,59,59,999),t}function Qe(a){const t=S(a),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Ue(a){const t=S(a);return+Te(t)==+Qe(t)}function Ve(a,t){const r=S(a),e=S(t),n=H(r,e),m=Math.abs(Ne(r,e));let s;if(m<1)s=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-n*m);let d=H(r,e)===-n;Ue(S(a))&&m===1&&H(a,e)===1&&(d=!1),s=n*(m-Number(d))}return s===0?0:s}function je(a,t,r){const e=Re(a,t)/1e3;return Le(r==null?void 0:r.roundingMethod)(e)}const Ke={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ge=(a,t,r)=>{let e;const n=Ke[a];return typeof n=="string"?e=n:t===1?e=n.one:e=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+e:e+" ago":e};function re(a){return(t={})=>{const r=t.width?String(t.width):a.defaultWidth;return a.formats[r]||a.formats[a.defaultWidth]}}const Xe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ye={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ze={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Je={date:re({formats:Xe,defaultWidth:"full"}),time:re({formats:Ye,defaultWidth:"full"}),dateTime:re({formats:ze,defaultWidth:"full"})},$e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},He=(a,t,r,e)=>$e[a];function U(a){return(t,r)=>{const e=r!=null&&r.context?String(r.context):"standalone";let n;if(e==="formatting"&&a.formattingValues){const s=a.defaultFormattingWidth||a.defaultWidth,d=r!=null&&r.width?String(r.width):s;n=a.formattingValues[d]||a.formattingValues[s]}else{const s=a.defaultWidth,d=r!=null&&r.width?String(r.width):a.defaultWidth;n=a.values[d]||a.values[s]}const m=a.argumentCallback?a.argumentCallback(t):t;return n[m]}}const Ze={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},et={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},tt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},at={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ot={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},rt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},nt=(a,t)=>{const r=Number(a),e=r%100;if(e>20||e<10)switch(e%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},it={ordinalNumber:nt,era:U({values:Ze,defaultWidth:"wide"}),quarter:U({values:et,defaultWidth:"wide",argumentCallback:a=>a-1}),month:U({values:tt,defaultWidth:"wide"}),day:U({values:at,defaultWidth:"wide"}),dayPeriod:U({values:ot,defaultWidth:"wide",formattingValues:rt,defaultFormattingWidth:"wide"})};function V(a){return(t,r={})=>{const e=r.width,n=e&&a.matchPatterns[e]||a.matchPatterns[a.defaultMatchWidth],m=t.match(n);if(!m)return null;const s=m[0],d=e&&a.parsePatterns[e]||a.parsePatterns[a.defaultParseWidth],v=Array.isArray(d)?lt(d,b=>b.test(s)):st(d,b=>b.test(s));let f;f=a.valueCallback?a.valueCallback(v):v,f=r.valueCallback?r.valueCallback(f):f;const _=t.slice(s.length);return{value:f,rest:_}}}function st(a,t){for(const r in a)if(Object.prototype.hasOwnProperty.call(a,r)&&t(a[r]))return r}function lt(a,t){for(let r=0;r<a.length;r++)if(t(a[r]))return r}function dt(a){return(t,r={})=>{const e=t.match(a.matchPattern);if(!e)return null;const n=e[0],m=t.match(a.parsePattern);if(!m)return null;let s=a.valueCallback?a.valueCallback(m[0]):m[0];s=r.valueCallback?r.valueCallback(s):s;const d=t.slice(n.length);return{value:s,rest:d}}}const ct=/^(\d+)(th|st|nd|rd)?/i,ut=/\d+/i,mt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ht={any:[/^b/i,/^(a|c)/i]},ft={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},yt={any:[/1/i,/2/i,/3/i,/4/i]},gt={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},vt={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_t={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pt={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},wt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},bt={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},It={ordinalNumber:dt({matchPattern:ct,parsePattern:ut,valueCallback:a=>parseInt(a,10)}),era:V({matchPatterns:mt,defaultMatchWidth:"wide",parsePatterns:ht,defaultParseWidth:"any"}),quarter:V({matchPatterns:ft,defaultMatchWidth:"wide",parsePatterns:yt,defaultParseWidth:"any",valueCallback:a=>a+1}),month:V({matchPatterns:gt,defaultMatchWidth:"wide",parsePatterns:vt,defaultParseWidth:"any"}),day:V({matchPatterns:_t,defaultMatchWidth:"wide",parsePatterns:pt,defaultParseWidth:"any"}),dayPeriod:V({matchPatterns:wt,defaultMatchWidth:"any",parsePatterns:bt,defaultParseWidth:"any"})},Ct={code:"en-US",formatDistance:Ge,formatLong:Je,formatRelative:He,localize:it,match:It,options:{weekStartsOn:0,firstWeekContainsDate:1}};function kt(a,t,r){const e=Ee(),n=(r==null?void 0:r.locale)??e.locale??Ct,m=2520,s=H(a,t);if(isNaN(s))throw new RangeError("Invalid time value");const d=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:s});let v,f;s>0?(v=S(t),f=S(a)):(v=S(a),f=S(t));const _=je(f,v),b=(me(f)-me(v))/1e3,k=Math.round((_-b)/60);let P;if(k<2)return r!=null&&r.includeSeconds?_<5?n.formatDistance("lessThanXSeconds",5,d):_<10?n.formatDistance("lessThanXSeconds",10,d):_<20?n.formatDistance("lessThanXSeconds",20,d):_<40?n.formatDistance("halfAMinute",0,d):_<60?n.formatDistance("lessThanXMinutes",1,d):n.formatDistance("xMinutes",1,d):k===0?n.formatDistance("lessThanXMinutes",1,d):n.formatDistance("xMinutes",k,d);if(k<45)return n.formatDistance("xMinutes",k,d);if(k<90)return n.formatDistance("aboutXHours",1,d);if(k<ue){const i=Math.round(k/60);return n.formatDistance("aboutXHours",i,d)}else{if(k<m)return n.formatDistance("xDays",1,d);if(k<z){const i=Math.round(k/ue);return n.formatDistance("xDays",i,d)}else if(k<z*2)return P=Math.round(k/z),n.formatDistance("aboutXMonths",P,d)}if(P=Ve(f,v),P<12){const i=Math.round(k/z);return n.formatDistance("xMonths",i,d)}else{const i=P%12,l=Math.trunc(P/12);return i<3?n.formatDistance("aboutXYears",l,d):i<9?n.formatDistance("overXYears",l,d):n.formatDistance("almostXYears",l+1,d)}}function xt(a,t){return kt(a,We(a),t)}const ne=new qe,he=new te,fe=new Fe,Mt={name:"Order",props:{intiativeId:{type:Number,required:!0}},data(){return{chosenFood:"",quantities:0,selectedFoods:[],editedOrder:{}}},components:{AppModal:ee},methods:{addFoodToBasket(){if(!this.chosenFood){w("Please select a food",{type:"error"});return}const a=fe.findFood({id:Number(this.chosenFood)});if(!a){w("Food not found",{type:"error"});return}if(this.selectedFoods.some(t=>t.food.id===(a==null?void 0:a.id))){w("Food already added",{type:"error"});return}if(!this.quantities){w("Please select a quantity",{type:"error"});return}this.selectedFoods.push({food:a,quantity:this.quantities})},removeFoodFromBasket(a){const t=this.selectedFoods.findIndex(r=>r.food.id===a);if(t===-1){w("Food not found",{type:"error"});return}this.selectedFoods.splice(t,1)},setEditedOrder(a){const t=he.getFoodFromOrder(a.id),r=t.reduce((e,n)=>e+n.risk,0)/t.length||1;this.editedOrder={...a,risk:r,foods:t}},createOrder(){const a=document.getElementById("order-name"),t=document.getElementById("order-delivery-date");if(!a||!t){w("Please fill all the fields",{type:"error"});return}if(!a.value||!t.value){w("Please fill all the fields",{type:"error"});return}const r=this.selectedFoods.reduce((s,d)=>s+Number(d.food.price)*d.quantity,0);if(!this.$props.intiativeId){w("Please select an initiative",{type:"error"});return}const e={id:0,name:a.value,initiativeId:this.$props.intiativeId,price:r,status:"pending",deliveryDate:new Date(t.value),isDeleted:!1},n=this.selectedFoods.map(s=>({foodId:s.food.id,quantity:s.quantity}));try{ne.makeOrder(e,n)}catch(s){w("Error creating order: "+s.message,{type:"error"});return}document.getElementById("close-modal-"+this.modalId).click(),w("Order created",{type:"success"}),this.setPage(1),this.loadOrder()},formatDistanceToNow:xt,deleteOrder(a){try{ne.cancelOrder(a)}catch(t){w("Error deleting order: "+t.message,{type:"error"});return}w("Order cancelled",{type:"success"}),this.loadOrder()}},setup(a){const t=B([]),r=B(1),e=B(""),n=B({isDeleted:!1});function m(){t.value=he.getOrders(a.intiativeId,!1).filter(i=>n.value.isDeleted?i.status==="cancelled":i.status!=="cancelled").filter(i=>e.value.trim()===""?!0:i.name.toLowerCase().includes(e.value)).filter((i,l)=>l>=(r.value-1)*10&&l<r.value*10)}async function s(i){i.orderKey===n.value.orderKey&&(i.orderBy=n.value.orderBy==="asc"?"desc":"asc"),n.value={...n.value,...i},m()}async function d(i){e.value=i,m()}async function v(){n.value={isDeleted:!1},m()}async function f(){r.value++,m()}async function _(){r.value--,m()}async function b(i){i<1&&(i=1),r.value=i,m()}m();function k(i){const l=P().find(D=>D.id===i);return l?l.name:"Food not found"}function P(){return fe.listFood({})}return{modalId:"addfood",orderService:ne,document,orders:t,nextPage:f,previousPage:_,setPage:b,page:r,setQuery:s,resetQuery:v,query:n,setSearch:d,getAllFood:P,getFoodNameById:k,loadOrder:m}}},O=a=>(G("data-v-fa0812fb"),a=a(),X(),a),Dt={class:"intro"},Pt={class:"bg-image h-100"},Bt={class:"mask d-flex align-items-center h-100"},Ft={class:"container"},St={class:"row justify-content-center"},qt={class:"col-12"},At={class:"d-flex align-items-center mb-3 gap-3 justify-content-between"},Ot=O(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[o("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"})],-1)),Et={class:"card shadow-2-strong"},Wt={class:"card-body"},Nt={class:"table-responsive"},Lt={class:"table table-borderless mb-0"},Rt={scope:"col"},Tt=O(()=>o("p",{class:"p-0 m-0"},"Name",-1)),Qt=O(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Ut=[Qt],Vt={scope:"col"},jt=O(()=>o("p",{class:"p-0 m-0"},"Price",-1)),Kt=O(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Gt=[Kt],Xt={scope:"col"},Yt=O(()=>o("p",{class:"p-0 m-0"},"Delivery Date",-1)),zt=O(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Jt=[zt],$t={scope:"col"},Ht=O(()=>o("p",{class:"p-0 m-0"},"Id",-1)),Zt=O(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),ea=[Zt],ta={key:0,scope:"col"},aa=["onClick"],oa=["data-bs-target"],ra=["data-bs-target"],na=["data-bs-target"],ia=["data-bs-target"],sa={key:0,class:"custom-row"},la=["onClick"],da=O(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x text-white",viewBox:"0 0 16 16"},[o("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"})],-1)),ca=[da],ua={class:"container d-flex pt-4 justify-content-between"},ma=O(()=>o("span",{"aria-hidden":"true"},"«",-1)),ha=O(()=>o("span",{"aria-hidden":"true"},"»",-1)),fa=["value"],ya=["onClick"],ga=O(()=>o("span",{style:{"background-color":"red","border-radius":"0.7em",height:"10px",width:"10px",color:"white",cursor:"pointer","aspect-ratio":"square"},class:"p-2 !rounded-md"},"x",-1));function va(a,t,r,e,n,m){var i;const s=C("CInputGroupText"),d=C("CFormInput"),v=C("CInputGroup"),f=C("CButton"),_=C("CButtonGroup"),b=C("CPaginationItem"),k=C("CPagination"),P=C("app-modal");return h(),g("section",Dt,[o("div",Pt,[o("div",Bt,[o("main",Ft,[o("div",St,[o("div",qt,[o("div",At,[c(v,{class:"w-25"},{default:u(()=>[c(s,null,{default:u(()=>[Ot]),_:1}),c(d,{onChange:t[0]||(t[0]=l=>e.setSearch(l.target.value)),placeholder:"Search","aria-label":"Search","aria-describedby":"search"})]),_:1}),c(_,{role:"group","aria-label":"Basic example"},{default:u(()=>[c(f,{color:"primary",active:!e.query.isDeleted,onClick:t[1]||(t[1]=l=>e.setQuery({isDeleted:!1}))},{default:u(()=>[I("Active")]),_:1},8,["active"]),c(f,{color:"primary",active:e.query.isDeleted,onClick:t[2]||(t[2]=l=>e.setQuery({isDeleted:!0}))},{default:u(()=>[I("Cancelled")]),_:1},8,["active"])]),_:1})]),o("div",Et,[o("div",Wt,[o("div",Nt,[o("table",Lt,[o("thead",null,[o("tr",null,[o("th",Rt,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[3]||(t[3]=l=>e.setQuery({orderKey:"name",orderBy:"asc"}))},[Tt,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="name"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Ut,4))])]),o("th",Vt,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[4]||(t[4]=l=>e.setQuery({orderKey:"price",orderBy:"asc"}))},[jt,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="price"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Gt,4))])]),o("th",Xt,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[5]||(t[5]=l=>e.setQuery({orderKey:"deliveryDate",orderBy:"asc"}))},[Yt,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="deliveryDate"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Jt,4))])]),o("th",$t,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[6]||(t[6]=l=>e.setQuery({orderKey:"id",orderBy:"asc"}))},[Ht,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="id"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},ea,4))])]),e.query.isDeleted?F("",!0):(h(),g("th",ta,"Cancel"))])]),o("tbody",null,[(h(!0),g(L,null,R(e.orders,l=>(h(),g("tr",{key:l.id,class:"table-row custom-row-parent",onClick:D=>m.setEditedOrder(l)},[o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(l.name),9,oa),o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(l.price),9,ra),o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(m.formatDistanceToNow(l.deliveryDate,{addSuffix:!0})),9,na),o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(l.id),9,ia),e.query.isDeleted?F("",!0):(h(),g("td",sa,[o("button",{type:"button",class:"btn btn-danger btn-sm px-3",onClick:D=>m.deleteOrder(l.id)},ca,8,la)]))],8,aa))),128))])])])])])])]),o("div",ua,[c(k,{"aria-label":"Page navigation example"},{default:u(()=>[e.page>1?(h(),A(b,{key:0,"aria-label":"Previous",style:{cursor:"pointer"},onClick:e.previousPage},{default:u(()=>[ma]),_:1},8,["onClick"])):F("",!0),c(b,{active:""},{default:u(()=>[I(p(e.page),1)]),_:1}),e.orders.length==10?(h(),A(b,{key:1,onClick:t[7]||(t[7]=l=>e.setPage(e.page+1)),style:{cursor:"pointer"}},{default:u(()=>[I(p(e.page+1),1)]),_:1})):F("",!0),e.orders.length==10?(h(),A(b,{key:2,onClick:t[8]||(t[8]=l=>e.setPage(e.page+2)),style:{cursor:"pointer"}},{default:u(()=>[I(p(e.page+2),1)]),_:1})):F("",!0),e.orders.length==10?(h(),A(b,{key:3,"aria-label":"Next",onClick:e.nextPage,style:{cursor:"pointer"}},{default:u(()=>[ha]),_:1},8,["onClick"])):F("",!0)]),_:1}),c(f,{"data-bs-toggle":"modal",type:"button","data-bs-target":"#"+e.modalId,color:"primary"},{default:u(()=>[I(" Add new order ")]),_:1},8,["data-bs-target"]),c(P,{targetId:e.modalId,title:"Add Order",description:"Create a new order",saveAction:m.createOrder},{default:u(()=>[o("p",null," Total Price "+p(n.selectedFoods&&n.selectedFoods.length?n.selectedFoods.reduce((l,D)=>l+Number(D.food.price)*D.quantity,0):0)+"€ ",1),c(v,{class:"mb-3"},{default:u(()=>[c(s,null,{default:u(()=>[I("Name")]),_:1}),c(d,{id:"order-name",placeholder:"Name","aria-label":"Name","aria-describedby":"basic-addon1"})]),_:1}),c(v,{class:"mb-3"},{default:u(()=>[c(s,null,{default:u(()=>[I("Delivery Date")]),_:1}),c(d,{id:"order-delivery-date",class:"form-control",type:"datetime-local",value:new Date().toISOString().replace("T"," ").substring(0,16)},null,8,["value"])]),_:1}),c(v,{class:"mb-3"},{default:u(()=>[c(s,null,{default:u(()=>[I("Food")]),_:1}),Z(o("select",{name:"selectFood",id:"selectFood","onUpdate:modelValue":t[9]||(t[9]=l=>n.chosenFood=l)},[(h(!0),g(L,null,R(e.getAllFood(),l=>(h(),g("option",{value:l.id,key:l.id},p(l.name)+" - "+p(l.price)+"€ ",9,fa))),128))],512),[[ie,n.chosenFood]]),Z(o("input",{type:"number",name:"quantity",id:"foodQuantity","onUpdate:modelValue":t[10]||(t[10]=l=>n.quantities=l)},null,512),[[pe,n.quantities]]),o("button",{onClick:t[11]||(t[11]=(...l)=>m.addFoodToBasket&&m.addFoodToBasket(...l))},"Add")]),_:1}),(h(!0),g(L,null,R(n.selectedFoods,l=>(h(),g("div",{key:l.food},[o("p",{onClick:D=>m.removeFoodFromBasket(l.food.id)},[I(p(l.food.name)+" - "+p(l.quantity)+" units - "+p(l.food.price)+" € ",1),ga],8,ya)]))),128))]),_:1},8,["targetId","saveAction"])])])]),c(P,{targetId:e.modalId+"-edit",title:(i=n.editedOrder)==null?void 0:i.name,description:"Edit order",saveButton:""},{default:u(()=>[c(v,{class:"mb-3"},{default:u(()=>{var l,D;return[c(s,null,{default:u(()=>[I(" Name ")]),_:1}),c(d,{id:"order-name-edit",disabled:"",placeholder:(l=n.editedOrder)==null?void 0:l.name,"aria-label":"Name","aria-describedby":"basic-addon1",value:(D=n.editedOrder)==null?void 0:D.name},null,8,["placeholder","value"])]}),_:1}),c(v,{class:"mb-3"},{default:u(()=>{var l,D;return[c(s,null,{default:u(()=>[I("Price (€)")]),_:1}),c(d,{id:"order-price-edit",disabled:"",placeholder:(l=n.editedOrder)==null?void 0:l.price,"aria-label":"Price","aria-describedby":"basic-addon1",value:Number((D=n.editedOrder)==null?void 0:D.price).toFixed(2)},null,8,["placeholder","value"])]}),_:1}),c(v,{class:"mb-3"},{default:u(()=>{var l,D;return[c(s,null,{default:u(()=>[I("Risk (0 - 5)")]),_:1}),c(d,{id:"order-risk-edit",disabled:"",placeholder:(l=n.editedOrder)==null?void 0:l.risk,"aria-label":"Risk","aria-describedby":"basic-addon1",value:(D=n.editedOrder)==null?void 0:D.risk},null,8,["placeholder","value"])]}),_:1}),(h(!0),g(L,null,R(n.editedOrder.foods,l=>(h(),A(v,{class:"mb-3",key:l.id},{default:u(()=>[c(s,null,{default:u(()=>[I("Food")]),_:1}),c(d,{id:"order-risk-edit",disabled:"",placeholder:l==null?void 0:l.name,"aria-label":"Risk","aria-describedby":"basic-addon1",value:(l==null?void 0:l.name)+" - "+Number(l.price).toFixed(2)+"€"},null,8,["placeholder","value"])]),_:2},1024))),128))]),_:1},8,["targetId","title"])])])}const _a=K(Mt,[["render",va],["__scopeId","data-v-fa0812fb"]]),j=new Se,pa=new te,wa={props:{intiativeId:{type:Number,required:!0}},components:{AppModal:ee},setup(a){const t=B([]);B([]);const r=B(1),e=B(""),n="addmaterial",m=B({isDeleted:!1}),s=B(null),d=B([]);function v(y){s.value=y}async function f(){t.value=await j.allMaterial({initiativeId:0,isDeleted:!1}).filter(y=>e.value.trim()===""?!0:y.name.toLowerCase().includes(e.value.toLowerCase())).filter((y,x)=>x>=(r.value-1)*10&&x<r.value*10)}async function _(){d.value=await j.allMaterial({initiativeId:a.intiativeId,isDeleted:!1}).filter(y=>e.value.trim()===""?!0:y.name.toLowerCase().includes(e.value.toLowerCase())).filter((y,x)=>x>=(r.value-1)*10&&x<r.value*10),console.log(d.value)}_();async function b(y){y.orderKey===m.value.orderKey&&(y.orderBy=m.value.orderBy==="asc"?"desc":"asc"),m.value={...m.value,...y},await f(),await _()}async function k(y){e.value=y,await f(),await _()}async function P(){m.value={isDeleted:!1},await f(),await _()}async function i(){r.value++,await f(),await _()}async function l(){r.value--,await f(),await _()}async function D(y){y<1&&(y=1),r.value=y,await f(),await _()}f();async function ae(){const y=document.getElementById("material-select"),x=document.getElementById("material-quantity");if(console.log(y.value,x.value),!y.value||!x.value){w("Please fill all the fields",{type:"error"});return}if(isNaN(Number(x.value))){w("Please insert a valid number",{type:"error"});return}const q=Y(Number(y.value));if(console.log(q),console.log(q==null?void 0:q.quantity,Number(x.value)),((q==null?void 0:q.quantity)??0)<Number(x.value)){w("Not enough material in stock",{type:"error"});return}if(!q){w("Material not found",{type:"error"});return}q.initiativeId=a.intiativeId;try{await pa.addMaterial({...q,quantity:Number(x.value)}),console.log(q),console.log(a.intiativeId),w("Material added to initiative",{type:"success"})}catch(Q){w(Q.message,{type:"error"});return}document.getElementById("close-modal-"+n).click(),await D(1),await f(),await _()}function Y(y){return t.value.find(x=>x.id===y)}async function oe(y){try{await j.deleteMaterial(y),await f(),await _(),w("Material deleted",{type:"success"})}catch(x){w("Error deleting material: "+x.message,{type:"error"})}}async function M(){var le,de,ce;const y=document.getElementById("material-name-edit"),x=document.getElementById("material-quantity-edit"),q=document.getElementById("material-delete-edit"),se=q?q.checked:!0,Q={id:((le=s.value)==null?void 0:le.id)||0,...s.value,name:y.value||((de=s.value)==null?void 0:de.name)||"default",quantity:x.value||((ce=s.value)==null?void 0:ce.quantity)||"default",isDeleted:!se};if(!Q.id){w("Error editing material: Material id not found",{type:"error"});return}try{await j.updateMaterial(Q.id,Q),await f(),await _(),w("Material edited",{type:"success"})}catch(_e){w("Error editing material: "+_e.message,{type:"error"});return}document.getElementById("close-modal-"+n+"-edit").click()}return{modalId:n,materialService:j,document,deleteMaterial:oe,materials:t,initativeMaterials:d,getInitiativeMaterials:_,addInitiativeMaterial:ae,nextPage:i,previousPage:l,setPage:D,page:r,setQuery:b,resetQuery:P,query:m,setSearch:k,setEditMaterial:v,editedMaterial:s,findMaterialById:Y,editMaterial:M}}},W=a=>(G("data-v-d8e73352"),a=a(),X(),a),ba={class:"intro"},Ia={class:"bg-image h-100"},Ca={class:"mask d-flex align-items-center h-100"},ka={class:"container"},xa={class:"row justify-content-center"},Ma={class:"col-12"},Da={class:"d-flex align-items-center mb-3 gap-3 justify-content-between"},Pa=W(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[o("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"})],-1)),Ba={class:"card shadow-2-strong"},Fa={class:"card-body"},Sa={class:"table-responsive"},qa={class:"table table-borderless mb-0"},Aa={scope:"col"},Oa=W(()=>o("p",{class:"p-0 m-0"},"Name",-1)),Ea=W(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Wa=[Ea],Na={scope:"col"},La=W(()=>o("p",{class:"p-0 m-0"},"Quantity",-1)),Ra=W(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Ta=[Ra],Qa={scope:"col"},Ua=W(()=>o("p",{class:"p-0 m-0"},"Id",-1)),Va=W(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),ja=[Va],Ka={key:0,scope:"col"},Ga=["data-bs-target"],Xa=["data-bs-target"],Ya=["data-bs-target"],za={key:0,class:"custom-row"},Ja=["onClick"],$a=W(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x text-white",viewBox:"0 0 16 16"},[o("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"})],-1)),Ha=[$a],Za={class:"container d-flex pt-4 justify-content-between"},eo=W(()=>o("span",{"aria-hidden":"true"},"«",-1)),to=W(()=>o("span",{"aria-hidden":"true"},"»",-1)),ao=["value"],oo=W(()=>o("div",null,null,-1));function ro(a,t,r,e,n,m){const s=C("CInputGroupText"),d=C("CFormInput"),v=C("CInputGroup"),f=C("CButton"),_=C("CButtonGroup"),b=C("CPaginationItem"),k=C("CPagination"),P=C("app-modal");return h(),g("section",ba,[o("div",Ia,[o("div",Ca,[o("main",ka,[o("div",xa,[o("div",Ma,[o("div",Da,[c(v,{class:"w-25"},{default:u(()=>[c(s,null,{default:u(()=>[Pa]),_:1}),c(d,{onChange:t[0]||(t[0]=i=>e.setSearch(i.target.value)),placeholder:"Search","aria-label":"Search","aria-describedby":"search"})]),_:1}),c(_,{role:"group","aria-label":"Basic example"},{default:u(()=>[c(f,{color:"primary",active:!e.query.isDeleted,onClick:t[1]||(t[1]=i=>e.setQuery({isDeleted:!1}))},{default:u(()=>[I("Active")]),_:1},8,["active"]),c(f,{color:"primary",active:e.query.isDeleted,onClick:t[2]||(t[2]=i=>e.setQuery({isDeleted:!0}))},{default:u(()=>[I("Deleted")]),_:1},8,["active"])]),_:1})]),o("div",Ba,[o("div",Fa,[o("div",Sa,[c(ge,{name:"fade"},{default:u(()=>[o("table",qa,[o("thead",null,[o("tr",null,[o("th",Aa,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[3]||(t[3]=i=>e.setQuery({orderKey:"name",orderBy:"asc"}))},[Oa,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="name"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Wa,4))])]),o("th",Na,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[4]||(t[4]=i=>e.setQuery({orderKey:"quantity",orderBy:"asc"}))},[La,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="quantity"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Ta,4))])]),o("th",Qa,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[5]||(t[5]=i=>e.setQuery({orderKey:"id",orderBy:"asc"}))},[Ua,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="id"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},ja,4))])]),e.query.isDeleted?F("",!0):(h(),g("th",Ka,"Delete"))])]),o("tbody",null,[(h(!0),g(L,null,R(e.initativeMaterials,i=>(h(),g("tr",{key:i.id,class:"table-row custom-row-parent"},[o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(i.name),9,Ga),o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(i.quantity),9,Xa),o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(i.id),9,Ya),i.isDeleted?F("",!0):(h(),g("td",za,[o("button",{type:"button",class:"btn btn-danger btn-sm px-3",onClick:l=>e.deleteMaterial(i.id)},Ha,8,Ja)]))]))),128))])])]),_:1})])])])])]),o("div",Za,[c(k,{"aria-label":"Page navigation example"},{default:u(()=>[e.page>1?(h(),A(b,{key:0,"aria-label":"Previous",style:{cursor:"pointer"},onClick:e.previousPage},{default:u(()=>[eo]),_:1},8,["onClick"])):F("",!0),c(b,{active:""},{default:u(()=>[I(p(e.page),1)]),_:1}),e.materials.length==10?(h(),A(b,{key:1,onClick:t[6]||(t[6]=i=>e.setPage(e.page+1)),style:{cursor:"pointer"}},{default:u(()=>[I(p(e.page+1),1)]),_:1})):F("",!0),e.materials.length==10?(h(),A(b,{key:2,onClick:t[7]||(t[7]=i=>e.setPage(e.page+2)),style:{cursor:"pointer"}},{default:u(()=>[I(p(e.page+2),1)]),_:1})):F("",!0),e.materials.length==10?(h(),A(b,{key:3,"aria-label":"Next",onClick:e.nextPage,style:{cursor:"pointer"}},{default:u(()=>[to]),_:1},8,["onClick"])):F("",!0)]),_:1}),c(f,{"data-bs-toggle":"modal",type:"button","data-bs-target":"#"+e.modalId,color:"primary"},{default:u(()=>[I(" Add new material ")]),_:1},8,["data-bs-target"]),c(P,{targetId:e.modalId,title:"Add Material",description:"Create a new material",saveAction:e.addInitiativeMaterial},{default:u(()=>[c(v,{class:"mb-3"},{default:u(()=>[c(s,null,{default:u(()=>[I("Material")]),_:1}),Z(o("select",{id:"material-select",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=i=>a.chosenMaterial=i)},[(h(!0),g(L,null,R(e.materials,i=>(h(),g("option",{value:i.id,key:i.id},p(i.id)+"-"+p(i.name)+": "+p(i.quantity),9,ao))),128))],512),[[ie,a.chosenMaterial]])]),_:1}),c(v,{class:"mb-3"},{default:u(()=>[c(s,null,{default:u(()=>[I("Quantity (units)")]),_:1}),c(d,{id:"material-quantity",placeholder:"Quantity","aria-label":"Quantity","aria-describedby":"basic-addon1",modelValue:a.materialQuantity,"onUpdate:modelValue":t[9]||(t[9]=i=>a.materialQuantity=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["targetId","saveAction"])]),oo])])])])}const no=K(wa,[["render",ro],["__scopeId","data-v-d8e73352"]]),J=new Be,ye=new te,io={props:{intiativeId:{type:Number,required:!0}},components:{AppModal:ee},setup(a){const t=B([]),r=B([]),e=B(1),n=B(""),m="adduser",s=B({isDeleted:!1});B({isDeleted:!1});const d=B(null);function v(M){d.value=M}async function f(){r.value=await J.listUsers({role:"worker"}).filter(M=>n.value.trim()===""?!0:M.name.includes(n.value)).filter((M,y)=>y>=(e.value-1)*10&&y<e.value*10)}function _(){const M=ye.getWorkers(a.intiativeId);console.log({auxworkers:M}),t.value=M.map(y=>{console.log({worker:y});const x=J.getUserJob(y.jobId);return console.log({job:x}),{...y,job:x}}).filter(y=>n.value.trim()===""?!0:y.name.includes(n.value)).filter((y,x)=>x>=(e.value-1)*10&&x<e.value*10).filter(y=>s.value.isDeleted?y.isDeleted:!y.isDeleted)}async function b(M){M.orderKey===s.value.orderKey&&(M.orderBy=s.value.orderBy==="asc"?"desc":"asc"),s.value={...s.value,...M},await f(),await _()}_();async function k(M){n.value=M,await f(),await _()}async function P(){s.value={isDeleted:!1},await f(),await _()}async function i(){e.value++,await f(),await _()}async function l(){e.value--,await f(),await _()}async function D(M){M<1&&(M=1),e.value=M,await f(),await _()}f();async function ae(){const M=document.getElementById("User-select"),y=Number(M.value);if(!y){w("Please fill all the fields",{type:"error"});return}try{await ye.addWorker(a.intiativeId,y)}catch(q){w(q.message,{type:"error"});return}document.getElementById("close-modal-"+m).click(),w("Worker created",{type:"success"}),await D(1),await f()}async function Y(M){try{await J.deleteUser(M),await f(),await _(),w("User deleted",{type:"success"})}catch(y){w("Error deleting user: "+y.message,{type:"error"})}}async function oe(){}return{modalId:"adduser",userService:J,document,deleteUser:Y,workers:t,users:r,addWorker:ae,nextPage:i,previousPage:l,setPage:D,page:e,setQuery:b,resetQuery:P,query:s,setSearch:k,setEditUser:v,editedUser:d,editUser:oe}}},E=a=>(G("data-v-a0216c44"),a=a(),X(),a),so={class:"intro"},lo={class:"bg-image h-100"},co={class:"mask d-flex align-items-center h-100"},uo={class:"container"},mo={class:"row justify-content-center"},ho={class:"col-12"},fo={class:"d-flex align-items-center mb-3 gap-3 justify-content-between"},yo=E(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[o("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"})],-1)),go={class:"card shadow-2-strong"},vo={class:"card-body"},_o={class:"table-responsive"},po={class:"table table-borderless mb-0"},wo={scope:"col"},bo=E(()=>o("p",{class:"p-0 m-0"},"Name",-1)),Io=E(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Co=[Io],ko={scope:"col"},xo=E(()=>o("p",{class:"p-0 m-0"},"Email",-1)),Mo=E(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Do=[Mo],Po=E(()=>o("th",{scope:"col"},"Job",-1)),Bo={scope:"col"},Fo=E(()=>o("p",{class:"p-0 m-0"},"Id",-1)),So=E(()=>o("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),qo=[So],Ao={key:0,scope:"col"},Oo=["onClick"],Eo=["data-bs-target"],Wo=["data-bs-target"],No=["data-bs-target"],Lo=["data-bs-target"],Ro={key:0,class:"custom-row"},To=["onClick"],Qo=E(()=>o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x text-white",viewBox:"0 0 16 16"},[o("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"})],-1)),Uo=[Qo],Vo={class:"container d-flex pt-4 justify-content-between"},jo=E(()=>o("span",{"aria-hidden":"true"},"«",-1)),Ko=E(()=>o("span",{"aria-hidden":"true"},"»",-1)),Go=["value"],Xo=E(()=>o("div",null,null,-1));function Yo(a,t,r,e,n,m){const s=C("CInputGroupText"),d=C("CFormInput"),v=C("CInputGroup"),f=C("CButton"),_=C("CButtonGroup"),b=C("CPaginationItem"),k=C("CPagination"),P=C("app-modal");return h(),g("section",so,[o("div",lo,[o("div",co,[o("main",uo,[o("div",mo,[o("div",ho,[o("div",fo,[c(v,{class:"w-25"},{default:u(()=>[c(s,null,{default:u(()=>[yo]),_:1}),c(d,{onChange:t[0]||(t[0]=i=>e.setSearch(i.target.value)),placeholder:"Search","aria-label":"Search","aria-describedby":"search"})]),_:1}),c(_,{role:"group","aria-label":"Basic example"},{default:u(()=>[c(f,{color:"primary",active:!e.query.isDeleted,onClick:t[1]||(t[1]=i=>e.setQuery({isDeleted:!1}))},{default:u(()=>[I("Active")]),_:1},8,["active"]),c(f,{color:"primary",active:e.query.isDeleted,onClick:t[2]||(t[2]=i=>e.setQuery({isDeleted:!0}))},{default:u(()=>[I("Deleted")]),_:1},8,["active"])]),_:1})]),o("div",go,[o("div",vo,[o("div",_o,[c(ge,{name:"fade"},{default:u(()=>[o("table",po,[o("thead",null,[o("tr",null,[o("th",wo,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[3]||(t[3]=i=>e.setQuery({orderKey:"name",orderBy:"asc"}))},[bo,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="name"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Co,4))])]),o("th",ko,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[4]||(t[4]=i=>e.setQuery({orderKey:"email",orderBy:"asc"}))},[xo,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="email"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Do,4))])]),Po,o("th",Bo,[o("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:t[5]||(t[5]=i=>e.setQuery({orderKey:"id",orderBy:"asc"}))},[Fo,(h(),g("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:N({transform:e.query.orderKey==="id"&&e.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},qo,4))])]),e.query.isDeleted?F("",!0):(h(),g("th",Ao,"Delete"))])]),o("tbody",null,[(h(!0),g(L,null,R(e.workers,i=>(h(),g("tr",{key:i.id,onClick:l=>e.setEditUser(i),class:"table-row custom-row-parent"},[o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(i.name),9,Eo),o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(i.email),9,Wo),o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(i.job.name),9,No),o("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+e.modalId+"-edit"},p(i.id),9,Lo),i.isDeleted?F("",!0):(h(),g("td",Ro,[o("button",{type:"button",class:"btn btn-danger btn-sm px-3",onClick:l=>e.deleteUser(i.id)},Uo,8,To)]))],8,Oo))),128))])])]),_:1})])])])])]),o("div",Vo,[c(k,{"aria-label":"Page navigation example"},{default:u(()=>[e.page>1?(h(),A(b,{key:0,"aria-label":"Previous",style:{cursor:"pointer"},onClick:e.previousPage},{default:u(()=>[jo]),_:1},8,["onClick"])):F("",!0),c(b,{active:""},{default:u(()=>[I(p(e.page),1)]),_:1}),e.users.length==10?(h(),A(b,{key:1,onClick:t[6]||(t[6]=i=>e.setPage(e.page+1)),style:{cursor:"pointer"}},{default:u(()=>[I(p(e.page+1),1)]),_:1})):F("",!0),e.users.length==10?(h(),A(b,{key:2,onClick:t[7]||(t[7]=i=>e.setPage(e.page+2)),style:{cursor:"pointer"}},{default:u(()=>[I(p(e.page+2),1)]),_:1})):F("",!0),e.users.length==10?(h(),A(b,{key:3,"aria-label":"Next",onClick:e.nextPage,style:{cursor:"pointer"}},{default:u(()=>[Ko]),_:1},8,["onClick"])):F("",!0)]),_:1}),c(f,{"data-bs-toggle":"modal",type:"button","data-bs-target":"#"+e.modalId,color:"primary"},{default:u(()=>[I(" Add new worker ")]),_:1},8,["data-bs-target"]),c(P,{targetId:e.modalId,title:"Add User",description:"Create a new user",saveAction:e.addWorker},{default:u(()=>[c(v,{class:"mb-3"},{default:u(()=>[c(s,null,{default:u(()=>[I("User")]),_:1}),Z(o("select",{id:"User-select",class:"User-control","onUpdate:modelValue":t[8]||(t[8]=i=>a.chosenUser=i)},[(h(!0),g(L,null,R(e.users,i=>(h(),g("option",{value:i.id,key:i.id},p(i.id)+" - "+p(i.name)+": ",9,Go))),128))],512),[[ie,a.chosenUser]])]),_:1})]),_:1},8,["targetId","saveAction"])]),Xo])])])])}const zo=K(io,[["render",Yo],["__scopeId","data-v-a0216c44"]]),$=new te,Jo={name:"InitiativeImages",props:{initiativeId:{type:Number,required:!0}},data(){return{images:[],uploading:!1,uploadProgress:0}},created(){this.loadImages()},methods:{async loadImages(){try{this.images=$.getImages(this.initiativeId)}catch(a){console.error("Erro ao carregar imagens:",a)}},handleFileUpload(){var r;const a=document.getElementById("file-upload"),t=(r=a==null?void 0:a.files)==null?void 0:r[0];$.addImage(this.initiativeId,t).then(()=>{w("Imagem adicionada com sucesso!",{type:"success"}),this.loadImages()}).catch(e=>{w(e.message,{type:"error"})})},async uploadImage(a){try{$.addImage(this.initiativeId,a)}catch(t){console.error("Erro ao adicionar imagem:",t)}},async removeImage(a){try{$.deleteImage(a),this.loadImages()}catch(t){console.error("Erro ao remover imagem:",t)}}}},ve=a=>(G("data-v-cccb8e89"),a=a(),X(),a),$o={class:"p-4"},Ho={key:0,class:"grid grid-cols-2 md:grid-cols-3 gap-4"},Zo=["src"],er=["onClick"],tr={key:1,class:"text-gray-500"},ar=ve(()=>o("p",null,"Não há imagens para esta iniciativa.",-1)),or=[ar],rr={class:"mt-6"},nr=ve(()=>o("input",{type:"file",id:"file-upload",class:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 focus:outline-none"},null,-1)),ir={key:2,class:"mt-4"},sr=["value"],lr={class:"text-sm text-gray-500 mt-2"};function dr(a,t,r,e,n,m){return h(),g("div",$o,[n.images.length?(h(),g("div",Ho,[(h(!0),g(L,null,R(n.images,s=>(h(),g("div",{key:s.id,class:"image-container"},[o("img",{src:s.data,alt:"Imagem da Iniciativa",class:"image"},null,8,Zo),o("button",{class:"remove-button",onClick:d=>m.removeImage(s.id)}," Remover ",8,er)]))),128))])):(h(),g("div",tr,or)),o("div",rr,[nr,o("button",{onClick:t[0]||(t[0]=(...s)=>m.handleFileUpload&&m.handleFileUpload(...s)),class:"mt-4 bg-primary text-white px-4 py-2 rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-opacity-50"}," Upload ")]),n.uploading?(h(),g("div",ir,[o("progress",{value:n.uploadProgress,max:"100",class:"w-full h-4 rounded bg-gray-200"},null,8,sr),o("p",lr,"Uploading... "+p(n.uploadProgress.toFixed(0))+"%",1)])):F("",!0)])}const cr=K(Jo,[["render",dr],["__scopeId","data-v-cccb8e89"]]),ur={components:{AppModal:ee,Order:_a,Material:no,Worker:zo,Gallery:cr},setup(){const a=we(),t=B(null);return t.value=parseInt(a.params.id,10)||null,t.value===null&&console.error("Initiative ID is required."),console.log("Initiative ID:",t.value),{initiativeId:t}}},T=a=>(G("data-v-3b43688b"),a=a(),X(),a),mr={class:"intro"},hr=T(()=>o("h1",{class:"px-2"},"Orders",-1)),fr=T(()=>o("br",null,null,-1)),yr=T(()=>o("h1",{class:"px-2"},"Materials",-1)),gr=T(()=>o("br",null,null,-1)),vr=T(()=>o("h1",{class:"px-2"},"Worker",-1)),_r=T(()=>o("br",null,null,-1)),pr=T(()=>o("h1",{class:"px-2"},"Gallery",-1));function wr(a,t,r,e,n,m){const s=C("order"),d=C("material"),v=C("worker"),f=C("gallery");return h(),g("section",mr,[o("div",null,[hr,c(s,{intiativeId:e.initiativeId},null,8,["intiativeId"]),fr,yr,c(d,{intiativeId:e.initiativeId},null,8,["intiativeId"]),gr,vr,c(v,{intiativeId:e.initiativeId},null,8,["intiativeId"]),_r,pr,c(f,{intiativeId:e.initiativeId},null,8,["intiativeId"])])])}const qr=K(ur,[["render",wr],["__scopeId","data-v-3b43688b"]]);export{qr as default};
