import{A as Z,i as w}from"./index-T0QmJW5x.js";import{S as J}from"./SuggestionService-CYWNT9ui.js";import{r as B,_ as U,l as f,k as e,i as a,w as o,T as X,f as b,g as v,j as d,p as L,q as I,F as Y,m as $,t as y,e as T,v as ee,x as te}from"./index-C3C4sA69.js";import"./SuggestionRepository-CYBXsh7L.js";import"./RepositoryInterface-TDgCEybl.js";const M=new J,ae={components:{AppModal:Z},setup(){const S=B([]),l=B(1),D=B(""),t="addsuggestion",p=B({isDeleted:!1,status:"Pending"}),q=B(null),c=B(["Pending","Approved","Rejected"]);function g(s){p.value.status=s,m()}function u(){p.value.status=c.value[(c.value.indexOf(p.value.status)+1)%c.value.length],m()}function C(s){console.log({model:s}),q.value=s}async function m(){S.value=await M.getAllSuggestions(p.value).filter(s=>{if(D.value.toLowerCase().trim()==="")return!0;const _=D.value.toLowerCase().trim();return s.description.toLowerCase().includes(_)||s.eventName.toLowerCase().includes(_)||s.email.includes(_)||s.id.toString().includes(_)||s.budget.toString().includes(_)||s.eventType.includes(_)}).filter((s,_)=>_>=(l.value-1)*10&&_<l.value*10)}async function x(){const s=document.getElementById("suggestion-name"),_=document.getElementById("suggestion-email"),N=document.getElementById("suggestion-local"),k=document.getElementById("suggestion-num-participants"),R=document.getElementById("suggestion-budget"),K=document.getElementById("suggestion-date"),V=document.getElementById("suggestion-description"),G=document.getElementById("suggestion-name-user");if(!s||!_||!N||!k||!R||!K||!V||!G){w("Error creating suggestion: Inputs not found",{type:"error"});return}if(!s.value||!_.value||!N.value||!k.value||!R.value||!K.value||!V.value||!G.value){w("Error creating suggestion: Inputs are empty",{type:"error"});return}const z=document.getElementById("suggestion-event-type").value;if(!z){w("Error creating suggestion: Event type not found",{type:"error"});return}function O(P){let Q=P.split(/\D/).map(W=>parseInt(W));return Q[1]=Q[1]-1,new Date(...Q).getTime()}const H=O(K.value);try{const P={createdOn:new Date,date:new Date(H),status:"Pending",description:V.value,id:0,isApproved:!1,isDeleted:!1,rejectedReason:"",eventName:s.value,email:_.value,local:N.value,numParticipants:parseInt(k.value),budget:parseFloat(R.value),eventType:z,name:G.value};await M.createSuggestion(P),await m(),w("Suggestion created",{type:"success"})}catch(P){w("Error creating suggestion: "+P.message,{type:"error"});return}document.getElementById("close-modal-"+t).click()}async function F(s){s.orderKey===p.value.orderKey&&(s.orderBy=p.value.orderBy==="asc"?"desc":"asc"),p.value={...p.value,...s},await m()}async function j(s){D.value=s,await m()}async function E(){p.value={isDeleted:!1},await m()}async function A(){l.value++,await m()}async function n(){l.value--,await m()}async function h(s){s<1&&(s=1),l.value=s,await m()}m();async function r(s){if(!document.getElementById("reject-reason")){w("Error rejecting suggestion: Reason not found",{type:"error"});return}try{await M.rejectSuggestion(s),await m(),w("Suggestion rejected",{type:"success"})}catch(k){w("Error rejecting suggestion: "+k.message,{type:"error"});return}document.getElementById("close-modal-"+t+"-reject").click(),m()}return{modalId:t,userService:M,document,suggestions:S,nextPage:A,previousPage:n,setPage:h,page:l,setQuery:F,resetQuery:E,query:p,setSearch:j,setEditSuggestion:C,editedSuggestion:q,rejectSuggestion:r,createSuggestion:x,nextPossibleStatus:u,setStatus:g}}},i=S=>(ee("data-v-bf5d9435"),S=S(),te(),S),oe={class:"intro"},se={class:"bg-image h-100"},ne={class:"mask d-flex align-items-center h-100"},le={class:"container"},ie={class:"row justify-content-center"},de={class:"col-12"},re={class:"d-flex justify-content-between align-items-center mb-3 gap-3"},ce=i(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[e("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"})],-1)),ue={class:"card shadow-2-strong"},ge={class:"card-body"},me={class:"table-responsive"},_e={class:"table table-borderless mb-0"},ve={scope:"col"},pe=i(()=>e("p",{class:"p-0 m-0"},"Event Name",-1)),be=i(()=>e("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),ye=[be],he={scope:"col"},fe=i(()=>e("p",{class:"p-0 m-0"},"Email",-1)),we=i(()=>e("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Se=[we],xe=i(()=>e("th",{scope:"col"},"Status",-1)),Ce={scope:"col"},Be=i(()=>e("p",{class:"p-0 m-0"},"Id",-1)),Ie=i(()=>e("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Ee=[Ie],ke=i(()=>e("th",{scope:"col"},"Event Type",-1)),Pe={scope:"col"},De=i(()=>e("p",{class:"p-0 m-0"},"Budget",-1)),je=i(()=>e("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Ae=[je],Ne={key:0,scope:"col"},Le=["data-bs-target","onClick"],Te={class:"custom-row"},Me={class:"custom-row"},qe={class:"custom-row"},Fe={class:"custom-row"},Re={class:"custom-row"},Ke={class:"custom-row"},Ve={key:0,class:"custom-row"},Ge=["data-bs-target","onClick"],Qe=i(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x text-white",viewBox:"0 0 16 16"},[e("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"})],-1)),ze=[Qe],Oe={class:"container d-flex pt-4 justify-content-between"},He=i(()=>e("span",{"aria-hidden":"true"},"«",-1)),We=i(()=>e("span",{"aria-hidden":"true"},"»",-1)),Ze=i(()=>e("div",{class:"col-lg-3 col-sm-6 mb-3 w-100"},[e("input",{id:"suggestion-date",class:"form-control",type:"datetime-local"}),e("span",{id:"startDateSelected"})],-1)),Je=i(()=>e("option",null,"Event Type",-1)),Ue=i(()=>e("option",{value:"food_safety"},"Food Safety",-1)),Xe=i(()=>e("option",{value:"healthy_diets"},"Healthy Diets",-1)),Ye=i(()=>e("option",{value:"zero_waste"},"Zero Waste",-1)),$e=i(()=>e("option",{value:"food_rescue"},"Food Rescue",-1)),et=i(()=>e("div",null,null,-1)),tt={class:"d-flex gap-2 w-100 flex-1"},at={class:"flex-fill"},ot=i(()=>e("label",{for:"",class:"text-small text-body-secondary mb-1"},"General Information",-1)),st={class:"d-flex col-lg-3 col-sm-6 mb-3 w-100"},nt=["value"],lt=i(()=>e("option",{value:"food_safety"},"Food Safety",-1)),it=i(()=>e("option",{value:"healthy_diets"},"Healthy Diets",-1)),dt=i(()=>e("option",{value:"zero_waste"},"Zero Waste",-1)),rt=i(()=>e("option",{value:"food_rescue"},"Food Rescue",-1)),ct={class:"flex-fill"},ut=i(()=>e("label",{for:"",class:"text-small text-body-secondary mb-1"},"Description",-1));function gt(S,l,D,t,p,q){const c=b("CInputGroupText"),g=b("CFormInput"),u=b("CInputGroup"),C=b("CButton"),m=b("CButtonGroup"),x=b("CPaginationItem"),F=b("CPagination"),j=b("CFormSelect"),E=b("app-modal"),A=b("CFormTextarea");return v(),f("section",oe,[e("div",se,[e("div",ne,[e("main",le,[e("div",ie,[e("div",de,[e("div",re,[a(u,{class:"w-25"},{default:o(()=>[a(c,null,{default:o(()=>[ce]),_:1}),a(g,{onChange:l[0]||(l[0]=n=>t.setSearch(n.target.value)),placeholder:"Search","aria-label":"Search","aria-describedby":"search"})]),_:1}),a(m,{role:"group","aria-label":"Basic example"},{default:o(()=>[a(C,{color:"primary",active:t.query.status==="Approved",onClick:l[1]||(l[1]=n=>t.setStatus("Approved"))},{default:o(()=>[d("Approved")]),_:1},8,["active"]),a(C,{color:"primary",active:t.query.status==="Pending",onClick:l[2]||(l[2]=n=>t.setStatus("Pending"))},{default:o(()=>[d("Pending")]),_:1},8,["active"]),a(C,{color:"primary",active:t.query.status==="Rejected",onClick:l[3]||(l[3]=n=>t.setStatus("Rejected"))},{default:o(()=>[d("Rejected")]),_:1},8,["active"])]),_:1})]),e("div",ue,[e("div",ge,[e("div",me,[a(X,{name:"fade"},{default:o(()=>[e("table",_e,[e("thead",null,[e("tr",null,[e("th",ve,[e("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:l[4]||(l[4]=n=>t.setQuery({orderKey:"eventName",orderBy:"asc"}))},[pe,(v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:L({transform:t.query.orderKey==="eventName"&&t.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},ye,4))])]),e("th",he,[e("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:l[5]||(l[5]=n=>t.setQuery({orderKey:"email",orderBy:"asc"}))},[fe,(v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:L({transform:t.query.orderKey==="email"&&t.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Se,4))])]),xe,e("th",Ce,[e("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:l[6]||(l[6]=n=>t.setQuery({orderKey:"id",orderBy:"asc"}))},[Be,(v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:L({transform:t.query.orderKey==="id"&&t.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Ee,4))])]),ke,e("th",Pe,[e("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:l[7]||(l[7]=n=>t.setQuery({orderKey:"budget",orderBy:"asc"}))},[De,(v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:L({transform:t.query.orderKey==="budget"&&t.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Ae,4))])]),t.query.status==="Pending"?(v(),f("th",Ne,"Reject")):I("",!0)])]),e("tbody",null,[(v(!0),f(Y,null,$(t.suggestions,n=>(v(),f("tr",{key:n.id,"data-bs-toggle":"modal","data-bs-target":"#"+t.modalId+"-edit",class:"table-row custom-row-parent",onClick:h=>t.setEditSuggestion(n)},[e("td",Te,y(n.eventName),1),e("td",Me,y(n.email),1),e("td",qe,y(n.status),1),e("td",Fe,y(n.id),1),e("td",Re,y(n.eventType),1),e("td",Ke,y(n.budget),1),n.status==="Pending"?(v(),f("td",Ve,[e("button",{type:"button",class:"btn btn-danger btn-sm px-3","data-bs-toggle":"modal","data-bs-target":"#"+t.modalId+"-reject",onClick:h=>t.setEditSuggestion(n)},ze,8,Ge)])):I("",!0)],8,Le))),128))])])]),_:1})])])])])]),e("div",Oe,[a(F,{"aria-label":"Page navigation example"},{default:o(()=>[t.page>1?(v(),T(x,{key:0,"aria-label":"Previous",style:{cursor:"pointer"},onClick:t.previousPage},{default:o(()=>[He]),_:1},8,["onClick"])):I("",!0),a(x,{active:""},{default:o(()=>[d(y(t.page),1)]),_:1}),t.suggestions.length==10?(v(),T(x,{key:1,onClick:l[8]||(l[8]=n=>t.setPage(t.page+1)),style:{cursor:"pointer"}},{default:o(()=>[d(y(t.page+1),1)]),_:1})):I("",!0),t.suggestions.length==10?(v(),T(x,{key:2,onClick:l[9]||(l[9]=n=>t.setPage(t.page+2)),style:{cursor:"pointer"}},{default:o(()=>[d(y(t.page+2),1)]),_:1})):I("",!0),t.suggestions.length==10?(v(),T(x,{key:3,"aria-label":"Next",onClick:t.nextPage,style:{cursor:"pointer"}},{default:o(()=>[We]),_:1},8,["onClick"])):I("",!0)]),_:1}),a(C,{"data-bs-toggle":"modal",type:"button","data-bs-target":"#"+t.modalId,color:"primary"},{default:o(()=>[d(" Add new suggestion ")]),_:1},8,["data-bs-target"]),a(E,{targetId:t.modalId,title:"Add Suggestion",description:"Create a new suggestion",saveAction:t.createSuggestion},{default:o(()=>[a(u,{class:"mb-3"},{default:o(()=>[a(c,null,{default:o(()=>[d("Event Name")]),_:1}),a(g,{id:"suggestion-name",placeholder:"Event Name","aria-label":"Event Name","aria-describedby":"basic-addon1"})]),_:1}),Ze,a(u,{class:"mb-3"},{default:o(()=>[a(c,null,{default:o(()=>[d("Description")]),_:1}),a(g,{id:"suggestion-description",placeholder:"Description","aria-label":"Description","aria-describedby":"basic-addon1"})]),_:1}),a(u,{class:"mb-3"},{default:o(()=>{var n,h;return[a(c,null,{default:o(()=>[d("Person Name")]),_:1}),a(g,{value:(n=t.editedSuggestion)==null?void 0:n.name,id:"suggestion-name-user",placeholder:(h=t.editedSuggestion)==null?void 0:h.name,"aria-label":"Name","aria-describedby":"basic-addon1"},null,8,["value","placeholder"])]}),_:1}),a(u,{class:"mb-3"},{default:o(()=>[a(c,null,{default:o(()=>[d("@")]),_:1}),a(g,{id:"suggestion-email",placeholder:"Email","aria-label":"Email","aria-describedby":"basic-addon1"})]),_:1}),a(u,{class:"mb-3"},{default:o(()=>[a(c,null,{default:o(()=>[d("Location")]),_:1}),a(g,{id:"suggestion-local",placeholder:"Local","aria-label":"Local","aria-describedby":"basic-addon1"})]),_:1}),a(u,{class:"mb-3"},{default:o(()=>[a(c,null,{default:o(()=>[d("Max. Participants")]),_:1}),a(g,{id:"suggestion-num-participants",placeholder:"Max number of participants","aria-label":"Participants","aria-describedby":"basic-addon1"})]),_:1}),a(u,{class:"mb-3"},{default:o(()=>[a(c,null,{default:o(()=>[d("Max. Budget (€)")]),_:1}),a(g,{id:"suggestion-budget",placeholder:"Budget (100.00)","aria-label":"Budget","aria-describedby":"basic-addon1"})]),_:1}),a(j,{"aria-label":"Default select example",class:"mb-3",id:"suggestion-event-type"},{default:o(()=>[Je,Ue,Xe,Ye,$e]),_:1})]),_:1},8,["targetId","saveAction"])]),et,a(E,{targetId:t.modalId+"-edit",title:"Suggestion Details",saveButton:"",description:"Here you can check a suggestion. To approve it, head over to the initiatives area and start creating one.",saveAction:t.createSuggestion,size:"lg"},{default:o(()=>{var n,h;return[e("div",tt,[e("aside",at,[ot,a(u,{class:"mb-3"},{default:o(()=>{var r,s;return[a(c,null,{default:o(()=>[d("Event Name")]),_:1}),a(g,{value:(r=t.editedSuggestion)==null?void 0:r.eventName,id:"suggestion-name",placeholder:(s=t.editedSuggestion)==null?void 0:s.eventName,"aria-label":"Event Name","aria-describedby":"basic-addon1",disabled:""},null,8,["value","placeholder"])]}),_:1}),e("div",st,[a(c,{class:"rounded-0"},{default:o(()=>[d("Date")]),_:1}),e("input",{id:"suggestion-date",class:"form-control rounded-0",type:"date",value:new Date(((n=t.editedSuggestion)==null?void 0:n.date)??0).toISOString().substring(0,10),disabled:""},null,8,nt)]),a(u,{class:"mb-3"},{default:o(()=>{var r,s;return[a(c,null,{default:o(()=>[d("Person Name")]),_:1}),a(g,{value:(r=t.editedSuggestion)==null?void 0:r.name,id:"suggestion-name-user",placeholder:(s=t.editedSuggestion)==null?void 0:s.eventName,"aria-label":"Event Name","aria-describedby":"basic-addon1",disabled:""},null,8,["value","placeholder"])]}),_:1}),a(u,{class:"mb-3"},{default:o(()=>{var r;return[a(c,null,{default:o(()=>[d("Email")]),_:1}),a(g,{id:"suggestion-email",placeholder:"Email","aria-label":"Email","aria-describedby":"basic-addon1",value:(r=t.editedSuggestion)==null?void 0:r.email,disabled:""},null,8,["value"])]}),_:1}),a(u,{class:"mb-3"},{default:o(()=>{var r;return[a(c,null,{default:o(()=>[d("Local")]),_:1}),a(g,{id:"suggestion-local",placeholder:"Local","aria-label":"Local","aria-describedby":"basic-addon1",value:(r=t.editedSuggestion)==null?void 0:r.local,disabled:""},null,8,["value"])]}),_:1}),a(u,{class:"mb-3"},{default:o(()=>{var r;return[a(c,null,{default:o(()=>[d("Max Participants")]),_:1}),a(g,{value:(r=t.editedSuggestion)==null?void 0:r.numParticipants,id:"suggestion-num-participants",placeholder:"Max number of participants","aria-label":"Participants","aria-describedby":"basic-addon1",disabled:""},null,8,["value"])]}),_:1}),a(u,{class:"mb-3"},{default:o(()=>{var r;return[a(c,null,{default:o(()=>[d("Budget")]),_:1}),a(g,{id:"suggestion-budget",placeholder:"Budget ($100.00)","aria-label":"Budget","aria-describedby":"basic-addon1",value:(r=t.editedSuggestion)==null?void 0:r.budget,disabled:""},null,8,["value"])]}),_:1}),a(u,{class:""},{default:o(()=>[a(c,null,{default:o(()=>[d("Event Type")]),_:1}),a(j,{"aria-label":"Default select example",id:"suggestion-event-type",disabled:""},{default:o(()=>{var r;return[e("option",null,y((r=t.editedSuggestion)==null?void 0:r.eventType),1),lt,it,dt,rt]}),_:1})]),_:1})]),e("aside",ct,[ut,a(A,{id:"suggestion-description",placeholder:"Description","aria-label":"Description","aria-describedby":"basic-addon1",value:(h=t.editedSuggestion)==null?void 0:h.description,disabled:""},null,8,["value"])])])]}),_:1},8,["targetId","saveAction"]),a(E,{targetId:t.modalId+"-reject",title:"Reject Suggestion",saveButton:"Send",description:"Provide a description as to why it is being rejected. This will then be sent to the email of the user.",saveAction:()=>{var n;return t.rejectSuggestion(((n=t.editedSuggestion)==null?void 0:n.id)??0)}},{default:o(()=>[a(u,null,{default:o(()=>[a(c,null,{default:o(()=>[d("Reason")]),_:1}),a(A,{"aria-label":"With textarea",id:"reject-reason"})]),_:1})]),_:1},8,["targetId","saveAction"])])])])])}const ht=U(ae,[["render",gt],["__scopeId","data-v-bf5d9435"]]);export{ht as default};
