import{A as X}from"./index-D_r6u122.js";import{U as Y}from"./UserService-o9p5zFJ_.js";import{i as g}from"./index-xEShUyOC.js";import{b as S,_ as Z,c as w,a as e,d as o,w as s,T as $,e as p,o as n,f as v,n as Q,g as I,F as ee,r as te,t as b,h as L,p as ae,i as oe}from"./index-CqBfKhJj.js";import"./RepositoryInterface-TDgCEybl.js";import"./config-Dvl3g2xv.js";const F=new Y,se={components:{AppModal:X},setup(){const C=S([]),l=S(1),B=S(""),t="adduser",f=S({isDeleted:!1}),c=S(null);function y(a){c.value=a}async function d(){C.value=await F.listUsers(f.value).filter(a=>B.value.trim()===""?!0:a.email.includes(B.value)||a.name.includes(B.value)).filter((a,u)=>u>=(l.value-1)*10&&u<l.value*10)}async function m(a){a.orderKey===f.value.orderKey&&(a.orderBy=f.value.orderBy==="asc"?"desc":"asc"),f.value={...f.value,...a},await d()}async function k(a){B.value=a,await d()}async function G(){f.value={isDeleted:!1},await d()}async function x(){l.value++,await d()}async function K(){l.value--,await d()}async function U(a){a<1&&(a=1),l.value=a,await d()}d();function E(a){return new Promise((u,_)=>{const h=new FileReader;h.onload=function(){u(h.result)},h.onerror=_,h.readAsDataURL(a)})}async function V(){const a=document.getElementById("user-name"),u=document.getElementById("user-email"),_=document.getElementById("user-role"),h=document.getElementById("user-image"),A=document.getElementById("user-password");if(!a||!u||!_||!h||!A){g("Please fill all the fields",{type:"error"});return}if(!a.value||!u.value||!_.value||!h.value||!A.value){g("Please fill all the fields",{type:"error"});return}if(_.value==="Role"){g("Please select a role",{type:"error"});return}const q=_.value,N={email:u.value,name:a.value,id:0,role:q,isDeleted:!1,password:A.value,jobId:0,photoUrl:await E(h.files[0])};try{await F.createUser(N)}catch(D){g(D.message,{type:"error"});return}document.getElementById("close-modal-"+t).click(),g("User created",{type:"success"}),await U(1),await d()}async function M(a){try{await F.deleteUser(a),await d(),g("User deleted",{type:"success"})}catch(u){g("Error deleting user: "+u.message,{type:"error"})}}async function r(){var R,j,T,z,H,W,J;const a=document.getElementById("user-name-edit"),u=document.getElementById("user-email-edit"),_=document.getElementById("user-role-edit"),h=document.getElementById("user-image-edit"),A=document.getElementById("user-password-edit"),q=document.getElementById("user-delete-edit");console.log({editedUser:c});const N=q?q.checked:!0;let P=((R=c.value)==null?void 0:R.photoUrl)||"";try{P=await E(h.files[0])||P}catch{P=((j=c.value)==null?void 0:j.photoUrl)||""}const D={id:((T=c.value)==null?void 0:T.id)||0,...c.value,name:a.value||((z=c.value)==null?void 0:z.name)||"default",email:u.value||((H=c.value)==null?void 0:H.email)||"default",role:(_==null?void 0:_.value)??((W=c.value)==null?void 0:W.role),photoUrl:P,password:A.value||((J=c.value)==null?void 0:J.password),isDeleted:!N};if(!D.id){g("Error editing user: User id not found",{type:"error"});return}try{await F.updateUser(D.id,D),await d(),g("User edited",{type:"success"})}catch(O){g("Error editing user: "+O.message,{type:"error"});return}document.getElementById("close-modal-"+t+"-edit").click()}return{modalId:"adduser",userService:F,document,deleteUser:M,users:C,createUser:V,nextPage:x,previousPage:K,setPage:U,page:l,setQuery:m,resetQuery:G,query:f,setSearch:k,setEditUser:y,editedUser:c,editUser:r}}},i=C=>(ae("data-v-1939dfa2"),C=C(),oe(),C),le={class:"intro"},re={class:"bg-image h-100"},de={class:"mask d-flex align-items-center h-100"},ie={class:"container"},ne={class:"row justify-content-center"},ce={class:"col-12"},ue={class:"d-flex align-items-center mb-3 gap-3 justify-content-between"},me=i(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[e("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"})],-1)),_e={class:"card shadow-2-strong"},he={class:"card-body"},ge={class:"table-responsive"},pe={class:"table table-borderless mb-0"},ve={scope:"col"},ye=i(()=>e("p",{class:"p-0 m-0"},"Name",-1)),fe=i(()=>e("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),we=[fe],be={scope:"col"},Ce=i(()=>e("p",{class:"p-0 m-0"},"Email",-1)),xe=i(()=>e("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Ie=[xe],Be=i(()=>e("th",{scope:"col"},"Role",-1)),ke={scope:"col"},Ue=i(()=>e("p",{class:"p-0 m-0"},"Id",-1)),Ee=i(()=>e("path",{"fill-rule":"evenodd",d:"M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4"},null,-1)),Ae=[Ee],Pe=i(()=>e("th",{scope:"col"},"Photo",-1)),De={key:0,scope:"col"},Se=["onClick"],Le=["data-bs-target"],Fe=["data-bs-target"],Me=["data-bs-target"],qe=["data-bs-target"],Ge=["data-bs-target"],Ke=["src"],Ve={key:0,class:"custom-row"},Ne=["onClick"],Qe=i(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x text-white",viewBox:"0 0 16 16"},[e("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"})],-1)),Re=[Qe],je={class:"container d-flex pt-4 justify-content-between"},Te=i(()=>e("span",{"aria-hidden":"true"},"«",-1)),ze=i(()=>e("span",{"aria-hidden":"true"},"»",-1)),He=i(()=>e("option",null,"Role",-1)),We=i(()=>e("option",{value:"worker"},"Worker",-1)),Je=i(()=>e("option",{value:"admin"},"Admin",-1)),Oe=i(()=>e("div",null,null,-1)),Xe=i(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",fill:"currentColor",class:"bi bi-person-fill",viewBox:"0 0 16 16"},[e("path",{d:"M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6"})],-1)),Ye=i(()=>e("option",{value:"worker"},"worker",-1)),Ze=i(()=>e("option",{value:"admin"},"admin",-1)),$e=i(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",fill:"currentColor",class:"bi bi-key",viewBox:"0 0 16 16"},[e("path",{d:"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5"}),e("path",{d:"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0"})],-1));function et(C,l,B,t,f,c){var M;const y=p("CInputGroupText"),d=p("CFormInput"),m=p("CInputGroup"),k=p("CButton"),G=p("CButtonGroup"),x=p("CPaginationItem"),K=p("CPagination"),U=p("CFormSelect"),E=p("app-modal"),V=p("CFormCheck");return n(),w("section",le,[e("div",re,[e("div",de,[e("main",ie,[e("div",ne,[e("div",ce,[e("div",ue,[o(m,{class:"w-25"},{default:s(()=>[o(y,null,{default:s(()=>[me]),_:1}),o(d,{onChange:l[0]||(l[0]=r=>t.setSearch(r.target.value)),placeholder:"Search","aria-label":"Search","aria-describedby":"search"})]),_:1}),o(G,{role:"group","aria-label":"Basic example"},{default:s(()=>[o(k,{color:"primary",active:!t.query.isDeleted,onClick:l[1]||(l[1]=r=>t.setQuery({isDeleted:!1}))},{default:s(()=>[v("Active")]),_:1},8,["active"]),o(k,{color:"primary",active:t.query.isDeleted,onClick:l[2]||(l[2]=r=>t.setQuery({isDeleted:!0}))},{default:s(()=>[v("Deleted")]),_:1},8,["active"])]),_:1})]),e("div",_e,[e("div",he,[e("div",ge,[o($,{name:"fade"},{default:s(()=>[e("table",pe,[e("thead",null,[e("tr",null,[e("th",ve,[e("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:l[3]||(l[3]=r=>t.setQuery({orderKey:"name",orderBy:"asc"}))},[ye,(n(),w("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:Q({transform:t.query.orderKey==="name"&&t.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},we,4))])]),e("th",be,[e("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:l[4]||(l[4]=r=>t.setQuery({orderKey:"email",orderBy:"asc"}))},[Ce,(n(),w("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:Q({transform:t.query.orderKey==="email"&&t.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Ie,4))])]),Be,e("th",ke,[e("div",{class:"d-flex align-items-center gap-2",style:{cursor:"pointer"},onClick:l[5]||(l[5]=r=>t.setQuery({orderKey:"id",orderBy:"asc"}))},[Ue,(n(),w("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-down-short",viewBox:"0 0 16 16",style:Q({transform:t.query.orderKey==="id"&&t.query.orderBy==="asc"?"rotate(180deg)":"rotate(0deg)"})},Ae,4))])]),Pe,t.query.isDeleted?I("",!0):(n(),w("th",De,"Delete"))])]),e("tbody",null,[(n(!0),w(ee,null,te(t.users,r=>(n(),w("tr",{key:r.id,onClick:a=>t.setEditUser(r),class:"table-row custom-row-parent"},[e("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+t.modalId+"-edit"},b(r.name),9,Le),e("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+t.modalId+"-edit"},b(r.email),9,Fe),e("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+t.modalId+"-edit"},b(r.role),9,Me),e("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+t.modalId+"-edit"},b(r.id),9,qe),e("td",{class:"custom-row","data-bs-toggle":"modal","data-bs-target":"#"+t.modalId+"-edit"},[e("img",{src:r.photoUrl,alt:"User photo",class:"bg-white",style:{"min-height":"40px",height:"40px",width:"40px","max-width":"40px",overflow:"hidden","border-radius":"50%","object-fit":"cover"}},null,8,Ke)],8,Ge),r.isDeleted?I("",!0):(n(),w("td",Ve,[e("button",{type:"button",class:"btn btn-danger btn-sm px-3",onClick:a=>t.deleteUser(r.id)},Re,8,Ne)]))],8,Se))),128))])])]),_:1})])])])])]),e("div",je,[o(K,{"aria-label":"Page navigation example"},{default:s(()=>[t.page>1?(n(),L(x,{key:0,"aria-label":"Previous",style:{cursor:"pointer"},onClick:t.previousPage},{default:s(()=>[Te]),_:1},8,["onClick"])):I("",!0),o(x,{active:""},{default:s(()=>[v(b(t.page),1)]),_:1}),t.users.length==10?(n(),L(x,{key:1,onClick:l[6]||(l[6]=r=>t.setPage(t.page+1)),style:{cursor:"pointer"}},{default:s(()=>[v(b(t.page+1),1)]),_:1})):I("",!0),t.users.length==10?(n(),L(x,{key:2,onClick:l[7]||(l[7]=r=>t.setPage(t.page+2)),style:{cursor:"pointer"}},{default:s(()=>[v(b(t.page+2),1)]),_:1})):I("",!0),t.users.length==10?(n(),L(x,{key:3,"aria-label":"Next",onClick:t.nextPage,style:{cursor:"pointer"}},{default:s(()=>[ze]),_:1},8,["onClick"])):I("",!0)]),_:1}),o(k,{"data-bs-toggle":"modal",type:"button","data-bs-target":"#"+t.modalId,color:"primary"},{default:s(()=>[v(" Add new user ")]),_:1},8,["data-bs-target"]),o(E,{targetId:t.modalId,title:"Add User",description:"Create a new user",saveAction:t.createUser},{default:s(()=>[o(m,{class:"mb-3"},{default:s(()=>[o(y,null,{default:s(()=>[v("@")]),_:1}),o(d,{id:"user-name",placeholder:"Name","aria-label":"Name","aria-describedby":"basic-addon1"})]),_:1}),o(m,{class:"mb-3"},{default:s(()=>[o(y,null,{default:s(()=>[v("@")]),_:1}),o(d,{id:"user-email",placeholder:"Email","aria-label":"Email","aria-describedby":"basic-addon1"})]),_:1}),o(U,{"aria-label":"Default select example",id:"user-role"},{default:s(()=>[He,We,Je]),_:1}),o(m,{class:"my-3"},{default:s(()=>[o(d,{id:"user-image",type:"file","aria-describedby":"inputGroupFileAddon03","aria-label":"Upload"})]),_:1}),o(m,{class:"mb-3"},{default:s(()=>[o(y,null,{default:s(()=>[v("@")]),_:1}),o(d,{placeholder:"Password","aria-label":"Password","aria-describedby":"basic-addon1",id:"user-password"})]),_:1})]),_:1},8,["targetId","saveAction"])]),Oe])]),o(E,{targetId:t.modalId+"-edit",title:(M=t.editedUser)==null?void 0:M.name,description:"Edit user",saveAction:t.editUser},{default:s(()=>{var r;return[o(m,{class:"mb-3"},{default:s(()=>{var a;return[o(y,null,{default:s(()=>[Xe]),_:1}),o(d,{id:"user-name-edit",placeholder:(a=t.editedUser)==null?void 0:a.name,"aria-label":"Name","aria-describedby":"basic-addon1"},null,8,["placeholder"])]}),_:1}),o(m,{class:"mb-3"},{default:s(()=>{var a;return[o(y,null,{default:s(()=>[v("@")]),_:1}),o(d,{id:"user-email-edit",placeholder:(a=t.editedUser)==null?void 0:a.email,"aria-label":"Email","aria-describedby":"basic-addon1"},null,8,["placeholder"])]}),_:1}),o(U,{"aria-label":"Default select example",id:"user-role-edit"},{default:s(()=>{var a;return[e("option",null,b((a=t.editedUser)==null?void 0:a.role),1),Ye,Ze]}),_:1}),o(m,{class:"my-3"},{default:s(()=>[o(d,{id:"user-image-edit",type:"file","aria-describedby":"inputGroupFileAddon03","aria-label":"Upload"})]),_:1}),o(m,{class:"mb-3"},{default:s(()=>{var a;return[o(y,null,{default:s(()=>[$e]),_:1}),o(d,{placeholder:(a=t.editedUser)==null?void 0:a.password,"aria-label":"Password","aria-describedby":"basic-addon1",id:"user-password-edit"},null,8,["placeholder"])]}),_:1}),(r=t.editedUser)!=null&&r.isDeleted?(n(),L(V,{key:0,id:"user-delete-edit",label:"Reactivate user"})):I("",!0)]}),_:1},8,["targetId","title","saveAction"])])])}const it=Z(se,[["render",et],["__scopeId","data-v-1939dfa2"]]);export{it as default};
